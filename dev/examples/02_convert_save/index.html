<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Converting, modifying and saving models · COBREXA.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="COBREXA.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="COBREXA.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">COBREXA.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quickstart/">COBREXA.jl in 10 minutes</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../">Contents</a></li><li><a class="tocitem" href="../01_loading/">Loading models</a></li><li class="is-active"><a class="tocitem" href>Converting, modifying and saving models</a><ul class="internal"><li><a class="tocitem" href="#Using-serialization-for-quick-loading-and-saving"><span>Using serialization for quick loading and saving</span></a></li><li><a class="tocitem" href="#Converting-and-saving-a-modified-model"><span>Converting and saving a modified model</span></a></li></ul></li><li><a class="tocitem" href="../03_exploring/">Exploring model contents</a></li><li><a class="tocitem" href="../03b_accessors/">Generic accessors</a></li><li><a class="tocitem" href="../04_core_model/"><code>CoreModel</code> usage</a></li><li><a class="tocitem" href="../04_standardmodel/">Basic usage of <code>StandardModel</code></a></li><li><a class="tocitem" href="../04b_standardmodel_construction/">Model construction and modification</a></li><li><a class="tocitem" href="../05a_fba/">Flux balance analysis (FBA)</a></li><li><a class="tocitem" href="../05b_fba_mods/">Extending FBA with modifications</a></li><li><a class="tocitem" href="../06_fva/">Flux variability analysis (FVA)</a></li><li><a class="tocitem" href="../07_gene_deletion/">Gene knockouts</a></li><li><a class="tocitem" href="../07_restricting_reactions/">Restricting and disabling individual reactions</a></li><li><a class="tocitem" href="../08_pfba/">Parsimonious flux balance analysis (pFBA)</a></li><li><a class="tocitem" href="../09_loopless/">Loopless FBA</a></li><li><a class="tocitem" href="../10_crowding/">FBA with crowding</a></li><li><a class="tocitem" href="../11_growth/">Growth media analysis</a></li><li><a class="tocitem" href="../12_mmdf/">Maximum-minimum driving force analysis</a></li><li><a class="tocitem" href="../13_moma/">Minimization of metabolic adjustment (MOMA)</a></li><li><a class="tocitem" href="../14_smoment/">sMOMENT</a></li><li><a class="tocitem" href="../15_gecko/">GECKO</a></li><li><a class="tocitem" href="../16_hit_and_run/">Hit and run sampling</a></li><li><a class="tocitem" href="../17_envelopes/">Production envelopes</a></li></ul></li><li><span class="tocitem">Parallel, distributed and HPC processing</span><ul><li><a class="tocitem" href="../../distributed/">Contents</a></li><li><a class="tocitem" href="../../distributed/1_functions/">Parallel processing overview</a></li><li><a class="tocitem" href="../../distributed/2_parallel/">Local parallel processing</a></li><li><a class="tocitem" href="../../distributed/3_slurm/">Working in a HPC environment</a></li><li><a class="tocitem" href="../../distributed/4_serialized/">Faster model distribution</a></li></ul></li><li><span class="tocitem">Core concepts guide</span><ul><li><a class="tocitem" href="../../concepts/">Contents</a></li><li><a class="tocitem" href="../../concepts/1_screen/">Screening many model variants</a></li><li><a class="tocitem" href="../../concepts/2_modifications/">Writing custom optimizer modifications</a></li><li><a class="tocitem" href="../../concepts/3_custom_models/">Working with custom models</a></li><li><a class="tocitem" href="../../concepts/4_wrappers/">Extending the models</a></li></ul></li><li><span class="tocitem">Reference (Functions and types)</span><ul><li><a class="tocitem" href="../../functions/">Contents</a></li><li><a class="tocitem" href="../../functions/analysis/">Analysis functions</a></li><li><a class="tocitem" href="../../functions/base/">Base functions</a></li><li><a class="tocitem" href="../../functions/io/">Input and output</a></li><li><a class="tocitem" href="../../functions/reconstruction/">Model construction functions</a></li><li><a class="tocitem" href="../../functions/types/">Types</a></li><li><a class="tocitem" href="../../functions/utils/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../howToContribute/">How to contribute</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Converting, modifying and saving models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Converting, modifying and saving models</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/lcsb-biocore/COBREXA.jl/blob/master/docs/src/examples/02_convert_save.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Converting,-modifying-and-saving-models"><a class="docs-heading-anchor" href="#Converting,-modifying-and-saving-models">Converting, modifying and saving models</a><a id="Converting,-modifying-and-saving-models-1"></a><a class="docs-heading-anchor-permalink" href="#Converting,-modifying-and-saving-models" title="Permalink"></a></h1><p>COBREXA.jl can export JSON and MATLAB-style model formats, which can be useful when exchanging the model data with other software.</p><p>For a test, let&#39;s download and open a SBML model:</p><pre><code class="language-julia">using COBREXA

!isfile(&quot;e_coli_core.xml&quot;) &amp;&amp;
    download(&quot;http://bigg.ucsd.edu/static/models/e_coli_core.xml&quot;, &quot;e_coli_core.xml&quot;);

sbml_model = load_model(&quot;e_coli_core.xml&quot;)</code></pre><pre class="documenter-example-output">Metabolic model of type SBMLModel
sparse([41, 23, 51, 67, 61, 65, 1, 7, 19, 28  …  72, 3, 8, 33, 57, 66, 31, 45, 46, 57], [1, 2, 2, 2, 3, 3, 4, 4, 4, 4  …  93, 94, 94, 94, 94, 94, 95, 95, 95, 95], [-1.0, -1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0, 1.0, -1.0  …  1.0, -1.0, 1.0, -1.0, 1.0, 1.0, 1.0, -1.0, -1.0, 1.0], 72, 95)
Number of reactions: 95
Number of metabolites: 72
</pre><p>You can save the model as <code>.json</code> or <code>.mat</code> file using the <a href="../../functions/io/#COBREXA.save_model-Tuple{MetabolicModel, String}"><code>save_model</code></a> function:</p><pre><code class="language-julia">save_model(sbml_model, &quot;converted_e_coli.json&quot;)
save_model(sbml_model, &quot;converted_e_coli.mat&quot;)</code></pre><h2 id="Using-serialization-for-quick-loading-and-saving"><a class="docs-heading-anchor" href="#Using-serialization-for-quick-loading-and-saving">Using serialization for quick loading and saving</a><a id="Using-serialization-for-quick-loading-and-saving-1"></a><a class="docs-heading-anchor-permalink" href="#Using-serialization-for-quick-loading-and-saving" title="Permalink"></a></h2><p>If you are saving the models only for future processing in Julia environment, it is often wasteful to encode the models to external formats and decode them back. Instead, you can use the &quot;native&quot; Julia data format, accessible with package <code>Serialization</code>.</p><p>This way, you can use <code>serialize</code> to save any model format (even the complicated <a href="../../functions/types/#COBREXA.StandardModel"><code>StandardModel</code></a>, which does not have a &quot;native&quot; file format representation):</p><pre><code class="language-julia">using Serialization

sm = convert(StandardModel, sbml_model)

open(f -&gt; serialize(f, sm), &quot;myModel.stdmodel&quot;, &quot;w&quot;)</code></pre><p>The models can then be loaded back using <code>deserialize</code>:</p><pre><code class="language-julia">sm2 = deserialize(&quot;myModel.stdmodel&quot;)
issetequal(metabolites(sm), metabolites(sm2))</code></pre><pre class="documenter-example-output">true</pre><p>This form of loading operation is usually pretty quick:</p><pre><code class="language-julia">t = @elapsed deserialize(&quot;myModel.stdmodel&quot;)
@info &quot;Deserialization took $t seconds&quot;</code></pre><pre class="documenter-example-output">[ Info: Deserialization took 0.005823892 seconds</pre><p>Notably, large and complicated models with thousands of reactions and annotations can take tens of seconds to decode properly. Serialization allows you to minimize this overhead, and scales well to tens of millions of reactions.</p><div class="admonition is-warning"><header class="admonition-header">Compatibility</header><div class="admonition-body"><p>The format of serialized models may change between Julia versions. In particular, never use the the serialized format for publishing models – others will have hard time finding the correct Julia version to open them. Similarly, never use serialized models for long-term storage – your future self will have hard time finding the historic Julia version that was used to write the data.</p></div></div><h2 id="Converting-and-saving-a-modified-model"><a class="docs-heading-anchor" href="#Converting-and-saving-a-modified-model">Converting and saving a modified model</a><a id="Converting-and-saving-a-modified-model-1"></a><a class="docs-heading-anchor-permalink" href="#Converting-and-saving-a-modified-model" title="Permalink"></a></h2><p>To modify the models easily, it is useful to convert them to a format that simplifies this modification. You may use e.g. <a href="../../functions/types/#COBREXA.CoreModel"><code>CoreModel</code></a> that exposes the usual matrix-and-vectors structure of models as used in MATLAB COBRA implementations, and <a href="../../functions/types/#COBREXA.StandardModel"><code>StandardModel</code></a> that contains structures, lists and dictionaries of model contents, as typical in Python COBRA implementations. The object-oriented nature of <a href="../../functions/types/#COBREXA.StandardModel"><code>StandardModel</code></a> is better for making small modifications that utilize known identifiers of model contents.</p><p>Conversion of any model to <a href="../../functions/types/#COBREXA.StandardModel"><code>StandardModel</code></a> can be performed using the standard Julia <code>convert</code>:</p><pre><code class="language-julia">sm = convert(StandardModel, sbml_model)</code></pre><pre class="documenter-example-output">Metabolic model of type StandardModel
sparse([41, 23, 51, 67, 61, 65, 1, 7, 19, 28  …  72, 3, 8, 33, 57, 66, 31, 45, 46, 57], [1, 2, 2, 2, 3, 3, 4, 4, 4, 4  …  93, 94, 94, 94, 94, 94, 95, 95, 95, 95], [-1.0, -1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0, 1.0, -1.0  …  1.0, -1.0, 1.0, -1.0, 1.0, 1.0, 1.0, -1.0, -1.0, 1.0], 72, 95)
Number of reactions: 95
Number of metabolites: 72
</pre><p>The conversion can be also achieved right away when loading the model, using an extra parameter of <a href="../../functions/io/#COBREXA.load_model-Tuple{String}"><code>load_model</code></a>:</p><pre><code class="language-julia">sm = load_model(StandardModel, &quot;e_coli_core.json&quot;)</code></pre><pre class="documenter-example-output">Metabolic model of type StandardModel
sparse([9, 51, 55, 64, 65, 34, 44, 59, 66, 64  …  20, 22, 23, 25, 16, 17, 34, 44, 57, 59], [1, 1, 1, 1, 1, 2, 2, 2, 2, 3  …  93, 93, 94, 94, 95, 95, 95, 95, 95, 95], [1.0, 1.0, -1.0, -1.0, 1.0, -1.0, 1.0, -1.0, 1.0, 1.0  …  1.0, -1.0, 1.0, -1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0], 72, 95)
Number of reactions: 95
Number of metabolites: 72
</pre><p>As an example, we change an upper bound on one of the reactions:</p><pre><code class="language-julia">sm.reactions[&quot;PFK&quot;].ub = 10.0</code></pre><pre class="documenter-example-output">10.0</pre><p>After <a href="../04_standardmodel/">possibly applying more modifications</a>, you can again save the modified model in a desirable exchange format:</p><pre><code class="language-julia">save_model(sm, &quot;modified_e_coli.json&quot;)
save_model(sm, &quot;modified_e_coli.mat&quot;)</code></pre><p>More information about <a href="../../functions/types/#COBREXA.StandardModel"><code>StandardModel</code></a> internals is available <a href="../04_standardmodel/">in a separate example</a>.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../01_loading/">« Loading models</a><a class="docs-footer-nextpage" href="../03_exploring/">Exploring model contents »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 24 November 2022 15:12">Thursday 24 November 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
