<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Flux variability analysis (FVA) · COBREXA.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="COBREXA.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="COBREXA.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">COBREXA.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quickstart/">COBREXA.jl in 10 minutes</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../">Contents</a></li><li><a class="tocitem" href="../01_loading/">Loading models</a></li><li><a class="tocitem" href="../02_convert_save/">Converting, modifying and saving models</a></li><li><a class="tocitem" href="../03_exploring/">Exploring model contents</a></li><li><a class="tocitem" href="../03b_accessors/">Generic accessors</a></li><li><a class="tocitem" href="../04_core_model/"><code>CoreModel</code> usage</a></li><li><a class="tocitem" href="../04_standardmodel/">Basic usage of <code>StandardModel</code></a></li><li><a class="tocitem" href="../04b_standardmodel_construction/">Model construction and modification</a></li><li><a class="tocitem" href="../05a_fba/">Flux balance analysis (FBA)</a></li><li><a class="tocitem" href="../05b_fba_mods/">Extending FBA with modifications</a></li><li class="is-active"><a class="tocitem" href>Flux variability analysis (FVA)</a><ul class="internal"><li><a class="tocitem" href="#Detailed-variability-analysis-with-modifications"><span>Detailed variability analysis with modifications</span></a></li><li><a class="tocitem" href="#Summarizing-the-flux-variability"><span>Summarizing the flux variability</span></a></li><li><a class="tocitem" href="#Retrieving-details-about-FVA-output"><span>Retrieving details about FVA output</span></a></li></ul></li><li><a class="tocitem" href="../07_gene_deletion/">Gene knockouts</a></li><li><a class="tocitem" href="../07_restricting_reactions/">Restricting and disabling individual reactions</a></li><li><a class="tocitem" href="../08_pfba/">Parsimonious flux balance analysis (pFBA)</a></li><li><a class="tocitem" href="../09_loopless/">Loopless FBA</a></li><li><a class="tocitem" href="../10_crowding/">FBA with crowding</a></li><li><a class="tocitem" href="../11_growth/">Growth media analysis</a></li><li><a class="tocitem" href="../12_mmdf/">Maximum-minimum driving force analysis</a></li><li><a class="tocitem" href="../13_moma/">Minimization of metabolic adjustment (MOMA)</a></li><li><a class="tocitem" href="../14_smoment/">sMOMENT</a></li><li><a class="tocitem" href="../15_gecko/">GECKO</a></li><li><a class="tocitem" href="../16_hit_and_run/">Hit and run sampling</a></li><li><a class="tocitem" href="../17_envelopes/">Production envelopes</a></li></ul></li><li><span class="tocitem">Parallel, distributed and HPC processing</span><ul><li><a class="tocitem" href="../../distributed/">Contents</a></li><li><a class="tocitem" href="../../distributed/1_functions/">Parallel processing overview</a></li><li><a class="tocitem" href="../../distributed/2_parallel/">Local parallel processing</a></li><li><a class="tocitem" href="../../distributed/3_slurm/">Working in a HPC environment</a></li><li><a class="tocitem" href="../../distributed/4_serialized/">Faster model distribution</a></li></ul></li><li><span class="tocitem">Core concepts guide</span><ul><li><a class="tocitem" href="../../concepts/">Contents</a></li><li><a class="tocitem" href="../../concepts/1_screen/">Screening many model variants</a></li><li><a class="tocitem" href="../../concepts/2_modifications/">Writing custom optimizer modifications</a></li><li><a class="tocitem" href="../../concepts/3_custom_models/">Working with custom models</a></li><li><a class="tocitem" href="../../concepts/4_wrappers/">Extending the models</a></li></ul></li><li><span class="tocitem">Reference (Functions and types)</span><ul><li><a class="tocitem" href="../../functions/">Contents</a></li><li><a class="tocitem" href="../../functions/analysis/">Analysis functions</a></li><li><a class="tocitem" href="../../functions/base/">Base functions</a></li><li><a class="tocitem" href="../../functions/io/">Input and output</a></li><li><a class="tocitem" href="../../functions/reconstruction/">Model construction functions</a></li><li><a class="tocitem" href="../../functions/types/">Types</a></li><li><a class="tocitem" href="../../functions/utils/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../howToContribute/">How to contribute</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Flux variability analysis (FVA)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Flux variability analysis (FVA)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/lcsb-biocore/COBREXA.jl/blob/master/docs/src/examples/06_fva.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Flux-variability-analysis-(FVA)"><a class="docs-heading-anchor" href="#Flux-variability-analysis-(FVA)">Flux variability analysis (FVA)</a><a id="Flux-variability-analysis-(FVA)-1"></a><a class="docs-heading-anchor-permalink" href="#Flux-variability-analysis-(FVA)" title="Permalink"></a></h1><p>Here we will use <a href="../../functions/analysis/#COBREXA.flux_variability_analysis-Tuple{MetabolicModel, Any}"><code>flux_variability_analysis</code></a> to analyze the <em>E. coli</em> core model.</p><p>As usual, if not already present, download the model and load the required packages. We picked the GLPK solver, but others may work as well:</p><pre><code class="language-julia">!isfile(&quot;e_coli_core.xml&quot;) &amp;&amp;
    download(&quot;http://bigg.ucsd.edu/static/models/e_coli_core.xml&quot;, &quot;e_coli_core.xml&quot;)

using COBREXA, GLPK

model = load_model(&quot;e_coli_core.xml&quot;)</code></pre><pre class="documenter-example-output">Metabolic model of type SBMLModel
sparse([8, 10, 21, 43, 50, 51, 8, 9, 6, 12  …  33, 66, 68, 72, 23, 26, 33, 72, 22, 33], [1, 1, 1, 1, 1, 1, 2, 2, 3, 3  …  93, 93, 93, 93, 94, 94, 94, 94, 95, 95], [-1.0, 1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0, -1.0, 1.0  …  1.0, -1.0, 1.0, -1.0, -1.0, 1.0, 1.0, -1.0, -1.0, 1.0], 72, 95)
Number of reactions: 95
Number of metabolites: 72
</pre><p>The FVA implementation in <a href="../../functions/analysis/#COBREXA.flux_variability_analysis-Tuple{MetabolicModel, Any}"><code>flux_variability_analysis</code></a> returns maximized and minimized reaction fluxes in a 2-column matrix. The bounds parameter function here (constructed with <a href="../../functions/utils/#COBREXA.objective_bounds-Tuple{Any}"><code>objective_bounds</code></a>) sets that the objective value is allowed to vary by 1% from the optimum found by FBA on the same model:</p><pre><code class="language-julia">flux_variability_analysis(model, GLPK.Optimizer; bounds = objective_bounds(0.99))</code></pre><pre class="documenter-example-output">95×2 Matrix{Float64}:
 -0.254237        0.0
 -0.254237        0.0
 -0.381356        0.0
  4.8143          7.56006
  4.8143          7.56006
 -0.381356        0.0
 -1.11022e-15     1.7161
  1.18233         6.62661
 -0.143008        0.0
 -0.221432        0.0
  ⋮            
  0.0             2.28813
  1.84464e-15     2.28813
  3.88085      1000.0
 -6.62661        -1.18233
  0.0691339       2.81489
 -8.88178e-16     6.8644
  0.0691339       2.81489
 -0.243197        2.50256
  6.16973         8.91549</pre><p>(You may also use <a href="../../functions/utils/#COBREXA.gamma_bounds-Tuple{Any}"><code>gamma_bounds</code></a>.)</p><h2 id="Detailed-variability-analysis-with-modifications"><a class="docs-heading-anchor" href="#Detailed-variability-analysis-with-modifications">Detailed variability analysis with modifications</a><a id="Detailed-variability-analysis-with-modifications-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-variability-analysis-with-modifications" title="Permalink"></a></h2><p>A dictionary-returning variant in <a href="../../functions/analysis/#COBREXA.flux_variability_analysis_dict-Tuple{MetabolicModel, Any}"><code>flux_variability_analysis_dict</code></a>, returns the result in a slightly more structured way. At the same time, we can specify additional <a href="../../concepts/2_modifications/">modifications</a> to be applied to the model:</p><pre><code class="language-julia">min_fluxes, max_fluxes = flux_variability_analysis_dict(
    model,
    GLPK.Optimizer;
    bounds = objective_bounds(0.99),
    modifications = [
        change_constraint(&quot;R_EX_glc__D_e&quot;; lb = -10, ub = -10),
        change_constraint(&quot;R_EX_o2_e&quot;; lb = 0.0, ub = 0.0),
    ],
)</code></pre><pre class="documenter-example-output">(Dict(&quot;R_EX_fum_e&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22607952490472283, &quot;R_GLNS&quot; =&gt; 0.053580994084844846, &quot;R_SUCOAS&quot; =&gt; 6.225897942841894e-15, &quot;R_TPI&quot; =&gt; 9.791564275259212, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593426, &quot;R_PPC&quot; =&gt; 0.6004759352738883, &quot;R_O2t&quot; =&gt; 1.7763568394002587e-15, &quot;R_G6PDH2r&quot; =&gt; 2.438809336803311e-15, &quot;R_TALA&quot; =&gt; -0.03748783669056421…), &quot;R_ACONTb&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22607952490472283, &quot;R_GLNS&quot; =&gt; 0.053580994084844624, &quot;R_SUCOAS&quot; =&gt; 9.383674941524645e-15, &quot;R_TPI&quot; =&gt; 9.791564275259212, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593473, &quot;R_PPC&quot; =&gt; 0.6004759352738988, &quot;R_O2t&quot; =&gt; 2.6645352591003883e-15, &quot;R_G6PDH2r&quot; =&gt; 2.1553062906483042e-15, &quot;R_TALA&quot; =&gt; -0.03748783669056422…), &quot;R_GLNS&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22607952490472882, &quot;R_GLNS&quot; =&gt; 0.053580994084844895, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.485804275258849, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593624, &quot;R_PPC&quot; =&gt; 0.6004759352738828, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; 0.9172800000013737, &quot;R_TALA&quot; =&gt; 0.2682721633098879…), &quot;R_SUCOAS&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.29557043399574195, &quot;R_GLNS&quot; =&gt; 0.05358099408484489, &quot;R_SUCOAS&quot; =&gt; -0.06949090909101316, &quot;R_TPI&quot; =&gt; 9.791564275259306, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593625, &quot;R_PPC&quot; =&gt; 0.669966844364897, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; -9.39717574588439e-17, &quot;R_TALA&quot; =&gt; -0.03748783669057004…), &quot;R_TPI&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22607952490472882, &quot;R_GLNS&quot; =&gt; 0.053580994084844895, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.485804275258849, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593624, &quot;R_PPC&quot; =&gt; 0.6004759352738828, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; 0.9172800000013737, &quot;R_TALA&quot; =&gt; 0.2682721633098879…), &quot;R_EX_pi_e&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22836315646940947, &quot;R_GLNS&quot; =&gt; 0.054122216247316675, &quot;R_SUCOAS&quot; =&gt; 3.874791485706844e-15, &quot;R_TPI&quot; =&gt; 9.789458863898215, &quot;R_EX_pi_e&quot; =&gt; -0.7786444931912458, &quot;R_PPC&quot; =&gt; 0.6065413487614906, &quot;R_O2t&quot; =&gt; 1.7763568394002587e-15, &quot;R_G6PDH2r&quot; =&gt; -4.768316294366138e-15, &quot;R_TALA&quot; =&gt; -0.03786650170764047…), &quot;R_PPC&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.2872315249048204, &quot;R_GLNS&quot; =&gt; 0.05358099408484489, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.791564275259306, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593624, &quot;R_PPC&quot; =&gt; 0.6004759352738829, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; -9.39717574588439e-17, &quot;R_TALA&quot; =&gt; -0.03748783669057004…), &quot;R_O2t&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.29254909012221963, &quot;R_GLNS&quot; =&gt; 0.05358099408484489, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.791564275259306, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593625, &quot;R_PPC&quot; =&gt; 0.6669455004913749, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; -1.879435149176878e-16, &quot;R_TALA&quot; =&gt; -0.03748783669057007…), &quot;R_G6PDH2r&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22607952490472105, &quot;R_GLNS&quot; =&gt; 0.05358099408484448, &quot;R_SUCOAS&quot; =&gt; 4.9960036108132044e-15, &quot;R_TPI&quot; =&gt; 9.791564275259217, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593473, &quot;R_PPC&quot; =&gt; 0.7915759352734985, &quot;R_O2t&quot; =&gt; -1.7763568394002587e-15, &quot;R_G6PDH2r&quot; =&gt; -6.240482714761413e-15, &quot;R_TALA&quot; =&gt; -0.03748783669056543…), &quot;R_TALA&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22836315646942648, &quot;R_GLNS&quot; =&gt; 0.05412221624731889, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.789458863898286, &quot;R_EX_pi_e&quot; =&gt; -0.778644493191287, &quot;R_PPC&quot; =&gt; 0.6065413487615077, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; 0.0, &quot;R_TALA&quot; =&gt; -0.03786650170764705…)…), Dict(&quot;R_EX_fum_e&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.28723152490482035, &quot;R_GLNS&quot; =&gt; 0.05358099408484489, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.791564275259306, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593624, &quot;R_PPC&quot; =&gt; 0.6004759352738829, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; 0.0, &quot;R_TALA&quot; =&gt; -0.037487836690570014…), &quot;R_ACONTb&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.29557043399574195, &quot;R_GLNS&quot; =&gt; 0.05358099408484489, &quot;R_SUCOAS&quot; =&gt; -0.06949090909101316, &quot;R_TPI&quot; =&gt; 9.791564275259306, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593625, &quot;R_PPC&quot; =&gt; 0.669966844364897, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; -9.39717574588439e-17, &quot;R_TALA&quot; =&gt; -0.03748783669057004…), &quot;R_GLNS&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22607952490472868, &quot;R_GLNS&quot; =&gt; 0.24468099408513094, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.791564275259308, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593625, &quot;R_PPC&quot; =&gt; 0.6004759352738851, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; 2.664535259100375e-16, &quot;R_TALA&quot; =&gt; -0.0374878366905699…), &quot;R_SUCOAS&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22607952490472877, &quot;R_GLNS&quot; =&gt; 0.05358099408484488, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.791564275259306, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593625, &quot;R_PPC&quot; =&gt; 0.600475935273883, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; 0.0, &quot;R_TALA&quot; =&gt; -0.03748783669056999…), &quot;R_TPI&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.28977952490482417, &quot;R_GLNS&quot; =&gt; 0.05358099408484488, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.791564275259306, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593625, &quot;R_PPC&quot; =&gt; 0.6641759352739797, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; 0.0, &quot;R_TALA&quot; =&gt; -0.03748783669056999…), &quot;R_EX_pi_e&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22607952490472874, &quot;R_GLNS&quot; =&gt; 0.05358099408484488, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.791564275259306, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593625, &quot;R_PPC&quot; =&gt; 0.6004759352738848, &quot;R_O2t&quot; =&gt; 1.387778780781446e-17, &quot;R_G6PDH2r&quot; =&gt; 0.0, &quot;R_TALA&quot; =&gt; -0.03748783669056999…), &quot;R_PPC&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22607952490472877, &quot;R_GLNS&quot; =&gt; 0.05358099408484488, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.791564275259306, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593625, &quot;R_PPC&quot; =&gt; 0.982675935274456, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; 0.0, &quot;R_TALA&quot; =&gt; -0.03748783669056999…), &quot;R_O2t&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.2897795249048397, &quot;R_GLNS&quot; =&gt; 0.053580994084844895, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.79156427525938, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593625, &quot;R_PPC&quot; =&gt; 0.6641759352739937, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; -2.2302160118670142e-13, &quot;R_TALA&quot; =&gt; -0.03748783669064436…), &quot;R_G6PDH2r&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22607952490472882, &quot;R_GLNS&quot; =&gt; 0.05358099408484489, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.485804275258849, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593624, &quot;R_PPC&quot; =&gt; 0.6004759352738829, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; 0.9172800000013739, &quot;R_TALA&quot; =&gt; 0.26827216330988796…), &quot;R_TALA&quot; =&gt; Dict(&quot;R_EX_fum_e&quot; =&gt; 0.0, &quot;R_ACONTb&quot; =&gt; 0.22607952490472877, &quot;R_GLNS&quot; =&gt; 0.05358099408484488, &quot;R_SUCOAS&quot; =&gt; 0.0, &quot;R_TPI&quot; =&gt; 9.485804275258849, &quot;R_EX_pi_e&quot; =&gt; -0.7708580482593624, &quot;R_PPC&quot; =&gt; 0.6004759352738848, &quot;R_O2t&quot; =&gt; 0.0, &quot;R_G6PDH2r&quot; =&gt; 0.9172800000013748, &quot;R_TALA&quot; =&gt; 0.2682721633098883…)…))</pre><p>The dictionaries can be easily used to explore the whole state of the model when certain reactions are maximized or minimized. For example, we can take the maximal acetate exchange flux when the acetate exchange is maximized:</p><pre><code class="language-julia">max_fluxes[&quot;R_EX_ac_e&quot;][&quot;R_EX_ac_e&quot;]</code></pre><pre class="documenter-example-output">8.51854942518171</pre><p>We can also check that the modifications really had the desired effect on oxygen consumption:</p><pre><code class="language-julia">max_fluxes[&quot;R_EX_ac_e&quot;][&quot;R_O2t&quot;]</code></pre><pre class="documenter-example-output">0.0</pre><p>...and see how much carbon dioxide would produced under at the given metabolic extreme:</p><pre><code class="language-julia">max_fluxes[&quot;R_EX_ac_e&quot;][&quot;R_EX_co2_e&quot;]</code></pre><pre class="documenter-example-output">-0.5654964103694404</pre><h2 id="Summarizing-the-flux-variability"><a class="docs-heading-anchor" href="#Summarizing-the-flux-variability">Summarizing the flux variability</a><a id="Summarizing-the-flux-variability-1"></a><a class="docs-heading-anchor-permalink" href="#Summarizing-the-flux-variability" title="Permalink"></a></h2><p>A convenience function <a href="../../functions/types/#COBREXA.flux_variability_summary-Tuple{Tuple{Dict{String, Dict{String, Float64}}, Dict{String, Dict{String, Float64}}}}"><code>flux_variability_summary</code></a> is able to display this information in a nice overview:</p><pre><code class="language-julia">flux_variability_summary((min_fluxes, max_fluxes))</code></pre><pre class="documenter-example-output">Biomass                       Lower bound   Upper bound
  R_BIOMASS_Ecoli_core_w_GAM: 0.2095        0.2095
Exchange
  R_EX_h_e:                   28.2555       30.7398
  R_EX_for_e:                 16.2978       17.8266
  R_EX_glc__D_e:              -10.0         -10.0
  R_EX_etoh_e:                8.0419        9.0611
  R_EX_ac_e:                  7.4484        8.5185
  R_EX_h2o_e:                 -7.1446       -6.3802
  R_EX_nh4_e:                 -1.2063       -1.1426
  R_EX_co2_e:                 -0.5655       1.1544
  R_EX_pi_e:                  -0.7786       -0.7709
  R_EX_lac__D_e:              0.0           0.5096
  R_EX_acald_e:               0.0           0.3058
  R_EX_pyr_e:                 0.0           0.2548
  R_EX_succ_e:                -0.0          0.1911
  R_EX_akg_e:                 0.0           0.0665
  R_EX_glu__L_e:              -0.0          0.0637
  R_EX_o2_e:                  -0.0          -0.0
  R_EX_fum_e:                 0.0           0.0
  R_EX_mal__L_e:              0.0           0.0
  R_EX_gln__L_e:              0.0           0.0
  R_EX_fru_e:                 0.0           0.0
</pre><h2 id="Retrieving-details-about-FVA-output"><a class="docs-heading-anchor" href="#Retrieving-details-about-FVA-output">Retrieving details about FVA output</a><a id="Retrieving-details-about-FVA-output-1"></a><a class="docs-heading-anchor-permalink" href="#Retrieving-details-about-FVA-output" title="Permalink"></a></h2><p>Parameter <code>ret</code> of <a href="../../functions/analysis/#COBREXA.flux_variability_analysis-Tuple{MetabolicModel, Any}"><code>flux_variability_analysis</code></a> can be used to extract specific pieces of information from the individual solved (minimized and maximized) optimization problems. Here we show how to extract the value of biomass &quot;growth&quot; along with the minimized/maximized reaction flux.</p><p>First, find the index of biomass reaction in all reactions</p><pre><code class="language-julia">biomass_idx = first(indexin([&quot;R_BIOMASS_Ecoli_core_w_GAM&quot;], reactions(model)))</code></pre><pre class="documenter-example-output">13</pre><p>Now run the FVA:</p><pre><code class="language-julia">vs = flux_variability_analysis(
    model,
    GLPK.Optimizer;
    bounds = objective_bounds(0.50), # objective can vary by up to 50% of the optimum
    modifications = [
        change_constraint(&quot;R_EX_glc__D_e&quot;; lb = -10, ub = -10),
        change_constraint(&quot;R_EX_o2_e&quot;; lb = 0.0, ub = 0.0),
    ],
    ret = optimized_model -&gt; (
        COBREXA.JuMP.objective_value(optimized_model),
        COBREXA.JuMP.value(optimized_model[:x][biomass_idx]),
    ),
)</code></pre><pre class="documenter-example-output">95×2 Matrix{Tuple{Float64, Float64}}:
 (-18.3915, 0.105831)     (-1.77636e-15, 0.105831)
 (-15.288, 0.105831)      (0.0, 0.105831)
 (-9.25179, 0.105831)     (0.0, 0.105831)
 (0.114182, 0.105831)     (3.4504, 0.105831)
 (0.114182, 0.105831)     (3.4504, 0.105831)
 (-9.25179, 0.105831)     (0.0, 0.105831)
 (7.18869e-15, 0.105831)  (9.555, 0.105831)
 (3.48454e-15, 0.105831)  (3.08393, 0.105831)
 (-3.09994, 0.105831)     (0.0, 0.105831)
 (-18.3915, 0.105831)     (9.54792e-15, 0.105831)
 ⋮                        
 (0.0, 0.105831)          (12.74, 0.105831)
 (0.0, 0.105831)          (12.74, 0.105831)
 (0.0, 0.105831)          (1000.0, 0.105831)
 (-3.08393, 0.105831)     (4.44089e-16, 0.105831)
 (-0.0378665, 0.211663)   (2.62444, 0.105831)
 (0.0, 0.207557)          (20.9246, 0.105831)
 (-0.0378665, 0.211663)   (2.62444, 0.105831)
 (-0.114277, 0.211663)    (2.58623, 0.105831)
 (7.25136, 0.105831)      (9.89473, 0.105831)</pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../05b_fba_mods/">« Extending FBA with modifications</a><a class="docs-footer-nextpage" href="../07_gene_deletion/">Gene knockouts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 31 October 2023 12:25">Tuesday 31 October 2023</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
