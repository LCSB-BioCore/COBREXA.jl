<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Flux balance analysis (FBA) · COBREXA.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="COBREXA.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="COBREXA.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">COBREXA.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quickstart/">COBREXA.jl in 10 minutes</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../">Contents</a></li><li><a class="tocitem" href="../01_loading/">Loading models</a></li><li><a class="tocitem" href="../02_convert_save/">Converting, modifying and saving models</a></li><li><a class="tocitem" href="../03_exploring/">Exploring model contents</a></li><li><a class="tocitem" href="../03b_accessors/">Generic accessors</a></li><li><a class="tocitem" href="../04_core_model/"><code>CoreModel</code> usage</a></li><li><a class="tocitem" href="../04_standardmodel/">Basic usage of <code>StandardModel</code></a></li><li><a class="tocitem" href="../04b_standardmodel_construction/">Model construction and modification</a></li><li class="is-active"><a class="tocitem" href>Flux balance analysis (FBA)</a></li><li><a class="tocitem" href="../05b_fba_mods/">Extending FBA with modifications</a></li><li><a class="tocitem" href="../06_fva/">Flux variability analysis (FVA)</a></li><li><a class="tocitem" href="../07_gene_deletion/">Gene knockouts</a></li><li><a class="tocitem" href="../07_restricting_reactions/">Restricting and disabling individual reactions</a></li><li><a class="tocitem" href="../08_pfba/">Parsimonious flux balance analysis (pFBA)</a></li><li><a class="tocitem" href="../09_loopless/">Loopless FBA</a></li><li><a class="tocitem" href="../10_crowding/">FBA with crowding</a></li><li><a class="tocitem" href="../11_growth/">Growth media analysis</a></li><li><a class="tocitem" href="../12_mmdf/">Maximum-minimum driving force analysis</a></li><li><a class="tocitem" href="../13_moma/">Minimization of metabolic adjustment (MOMA)</a></li><li><a class="tocitem" href="../14_smoment/">sMOMENT</a></li><li><a class="tocitem" href="../15_gecko/">GECKO</a></li><li><a class="tocitem" href="../16_hit_and_run/">Hit and run sampling</a></li><li><a class="tocitem" href="../17_envelopes/">Production envelopes</a></li></ul></li><li><span class="tocitem">Parallel, distributed and HPC processing</span><ul><li><a class="tocitem" href="../../distributed/">Contents</a></li><li><a class="tocitem" href="../../distributed/1_functions/">Parallel processing overview</a></li><li><a class="tocitem" href="../../distributed/2_parallel/">Local parallel processing</a></li><li><a class="tocitem" href="../../distributed/3_slurm/">Working in a HPC environment</a></li><li><a class="tocitem" href="../../distributed/4_serialized/">Faster model distribution</a></li></ul></li><li><span class="tocitem">Core concepts guide</span><ul><li><a class="tocitem" href="../../concepts/">Contents</a></li><li><a class="tocitem" href="../../concepts/1_screen/">Screening many model variants</a></li><li><a class="tocitem" href="../../concepts/2_modifications/">Writing custom optimizer modifications</a></li><li><a class="tocitem" href="../../concepts/3_custom_models/">Working with custom models</a></li><li><a class="tocitem" href="../../concepts/4_wrappers/">Extending the models</a></li></ul></li><li><span class="tocitem">Reference (Functions and types)</span><ul><li><a class="tocitem" href="../../functions/">Contents</a></li><li><a class="tocitem" href="../../functions/analysis/">Analysis functions</a></li><li><a class="tocitem" href="../../functions/base/">Base functions</a></li><li><a class="tocitem" href="../../functions/io/">Input and output</a></li><li><a class="tocitem" href="../../functions/reconstruction/">Model construction functions</a></li><li><a class="tocitem" href="../../functions/types/">Types</a></li><li><a class="tocitem" href="../../functions/utils/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../howToContribute/">How to contribute</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Flux balance analysis (FBA)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Flux balance analysis (FBA)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/lcsb-biocore/COBREXA.jl/blob/master/docs/src/examples/05a_fba.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Flux-balance-analysis-(FBA)"><a class="docs-heading-anchor" href="#Flux-balance-analysis-(FBA)">Flux balance analysis (FBA)</a><a id="Flux-balance-analysis-(FBA)-1"></a><a class="docs-heading-anchor-permalink" href="#Flux-balance-analysis-(FBA)" title="Permalink"></a></h1><p>We will use <a href="../../functions/analysis/#COBREXA.flux_balance_analysis-Union{Tuple{M}, Tuple{M, Any}} where M&lt;:MetabolicModel"><code>flux_balance_analysis</code></a> and several related functions to find the optimal flux in the <em>E. coli</em> &quot;core&quot; model.</p><p>If it is not already present, download the model and load the package:</p><pre><code class="language-julia">!isfile(&quot;e_coli_core.xml&quot;) &amp;&amp;
    download(&quot;http://bigg.ucsd.edu/static/models/e_coli_core.xml&quot;, &quot;e_coli_core.xml&quot;)

using COBREXA

model = load_model(&quot;e_coli_core.xml&quot;)</code></pre><pre class="documenter-example-output">Metabolic model of type SBMLModel
sparse([8, 10, 21, 43, 50, 51, 8, 9, 6, 12  …  33, 66, 68, 72, 23, 26, 33, 72, 22, 33], [1, 1, 1, 1, 1, 1, 2, 2, 3, 3  …  93, 93, 93, 93, 94, 94, 94, 94, 95, 95], [-1.0, 1.0, -1.0, 1.0, -1.0, 1.0, 1.0, -1.0, -1.0, 1.0  …  1.0, -1.0, 1.0, -1.0, -1.0, 1.0, 1.0, -1.0, -1.0, 1.0], 72, 95)
Number of reactions: 95
Number of metabolites: 72
</pre><p>To perform any optimization-based analysis, we need to use a linear programming solver (also called an optimizer). Any of the <a href="https://jump.dev/JuMP.jl/stable/installation/#Supported-solvers"><code>JuMP.jl</code>-supported optimizers</a> will work. Here, we will demonstrate <a href="https://github.com/ds4dm/Tulip.jl"><code>Tulip.jl</code></a> and <a href="https://www.gnu.org/software/glpk/">GLPK</a>; other solvers will likely work just as well.</p><pre><code class="language-julia">using Tulip

solved_model = flux_balance_analysis(model, Tulip.Optimizer)</code></pre><pre class="documenter-example-output">A JuMP Model
Maximization problem with:
Variables: 95
Objective function type: JuMP.AffExpr
`JuMP.AffExpr`-in-`MathOptInterface.EqualTo{Float64}`: 72 constraints
`JuMP.AffExpr`-in-`MathOptInterface.LessThan{Float64}`: 190 constraints
Model mode: AUTOMATIC
CachingOptimizer state: ATTACHED_OPTIMIZER
Solver name: Tulip
Names registered in the model: lbs, mb, ubs, x</pre><p><code>solved_model</code> is now an instance of optimized JuMP model. To get the variable values out manually, we can use <code>JuMP.value</code> function. Flux variables are stored as vector <code>x</code>:</p><pre><code class="language-julia">using JuMP
value.(solved_model[:x])</code></pre><pre class="documenter-example-output">95-element Vector{Float64}:
  -5.62439030120323e-9
  -4.201129368838846e-9
  -3.3923987790069394e-9
   6.007249566759449
   6.00724956675944
  -3.3924030713751446e-9
   2.8591669740742613e-8
   5.064375361904729
  -3.847904111734164e-9
  -1.4232688663206453e-9
   ⋮
   2.3807910379998874e-8
   2.532925798014968e-8
 494.2414417548114
  -5.064375361904718
   1.4969838025832385
   3.373717085310436e-7
   1.4969838025832798
   1.18149814026048
   7.4773819191983355</pre><p>To simplify things, there is a variant of the FBA function that does this for us automatically:</p><pre><code class="language-julia">flux_balance_analysis_vec(model, Tulip.Optimizer)</code></pre><pre class="documenter-example-output">95-element Vector{Float64}:
  -5.62439030120323e-9
  -4.201129368838846e-9
  -3.3923987790069394e-9
   6.007249566759449
   6.00724956675944
  -3.3924030713751446e-9
   2.8591669740742613e-8
   5.064375361904729
  -3.847904111734164e-9
  -1.4232688663206453e-9
   ⋮
   2.3807910379998874e-8
   2.532925798014968e-8
 494.2414417548114
  -5.064375361904718
   1.4969838025832385
   3.373717085310436e-7
   1.4969838025832798
   1.18149814026048
   7.4773819191983355</pre><p>Likewise, there is another variant that returns the fluxes annotated by reaction names, in a dictionary:</p><pre><code class="language-julia">flux_balance_analysis_dict(model, Tulip.Optimizer)</code></pre><pre class="documenter-example-output">Dict{String, Float64} with 95 entries:
  &quot;R_EX_fum_e&quot;    =&gt; 0.0
  &quot;R_ACONTb&quot;      =&gt; 6.00725
  &quot;R_GLNS&quot;        =&gt; 0.223462
  &quot;R_SUCOAS&quot;      =&gt; -5.06438
  &quot;R_TPI&quot;         =&gt; 7.47738
  &quot;R_EX_pi_e&quot;     =&gt; -3.2149
  &quot;R_PPC&quot;         =&gt; 2.50431
  &quot;R_O2t&quot;         =&gt; 21.7995
  &quot;R_G6PDH2r&quot;     =&gt; 4.95999
  &quot;R_TALA&quot;        =&gt; 1.49698
  &quot;R_PPCK&quot;        =&gt; 5.88441e-8
  &quot;R_EX_lac__D_e&quot; =&gt; 2.37701e-9
  &quot;R_PGL&quot;         =&gt; 4.95999
  &quot;R_H2Ot&quot;        =&gt; -29.1758
  &quot;R_GLNabc&quot;      =&gt; 0.0
  &quot;R_EX_co2_e&quot;    =&gt; 22.8098
  &quot;R_EX_gln__L_e&quot; =&gt; 0.0
  &quot;R_EX_nh4_e&quot;    =&gt; -4.76532
  &quot;R_MALt2_2&quot;     =&gt; 0.0
  ⋮               =&gt; ⋮</pre><p>Switching solvers is easy, and may be useful in case we need advanced functionality or performance present only in certain solvers. To switch to GLPK, we simply load the package and use a different optimizer to run the analysis:</p><pre><code class="language-julia">using GLPK
flux_balance_analysis_dict(model, GLPK.Optimizer)</code></pre><pre class="documenter-example-output">Dict{String, Float64} with 95 entries:
  &quot;R_EX_fum_e&quot;    =&gt; 0.0
  &quot;R_ACONTb&quot;      =&gt; 6.00725
  &quot;R_GLNS&quot;        =&gt; 0.223462
  &quot;R_SUCOAS&quot;      =&gt; -5.06438
  &quot;R_TPI&quot;         =&gt; 7.47738
  &quot;R_EX_pi_e&quot;     =&gt; -3.2149
  &quot;R_PPC&quot;         =&gt; 2.50431
  &quot;R_O2t&quot;         =&gt; 21.7995
  &quot;R_G6PDH2r&quot;     =&gt; 4.95998
  &quot;R_TALA&quot;        =&gt; 1.49698
  &quot;R_PPCK&quot;        =&gt; -7.10543e-15
  &quot;R_EX_lac__D_e&quot; =&gt; 1.83673e-14
  &quot;R_PGL&quot;         =&gt; 4.95998
  &quot;R_H2Ot&quot;        =&gt; -29.1758
  &quot;R_GLNabc&quot;      =&gt; 0.0
  &quot;R_EX_co2_e&quot;    =&gt; 22.8098
  &quot;R_EX_gln__L_e&quot; =&gt; 0.0
  &quot;R_EX_nh4_e&quot;    =&gt; -4.76532
  &quot;R_MALt2_2&quot;     =&gt; 0.0
  ⋮               =&gt; ⋮</pre><p>To get a shortened but useful overview of what was found in the analysis, you can use <a href="../../functions/types/#COBREXA.flux_summary-Tuple{Union{Nothing, Dict{String, Float64}}}"><code>flux_summary</code></a> function:</p><pre><code class="language-julia">flux_summary(flux_balance_analysis_dict(model, GLPK.Optimizer))</code></pre><pre class="documenter-example-output">Biomass
  R_BIOMASS_Ecoli_core_w_GAM: 0.8739
Import
  R_EX_o2_e:                  -21.7995
  R_EX_glc__D_e:              -10.0
  R_EX_nh4_e:                 -4.7653
  R_EX_pi_e:                  -3.2149
Export
  R_EX_h_e:                   17.5309
  R_EX_co2_e:                 22.8098
  R_EX_h2o_e:                 29.1758
</pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../04b_standardmodel_construction/">« Model construction and modification</a><a class="docs-footer-nextpage" href="../05b_fba_mods/">Extending FBA with modifications »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 8 May 2023 10:31">Monday 8 May 2023</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
